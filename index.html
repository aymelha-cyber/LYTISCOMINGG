<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Love You Teacher - Maze Game</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #2c3e50;
            color: white;
            text-align: center;
            margin: 0;
            padding: 20px;
            overflow: hidden;
        }
        #game-container {
            display: none;
            margin-top: 10px;
        }
        .header-info {
            display: flex;
            justify-content: center;
            gap: 30px;
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 10px;
        }
        #timer { color: #e74c3c; }
        
        #maze {
            display: grid;
            grid-template-columns: repeat(12, 40px);
            grid-template-rows: repeat(12, 40px);
            gap: 2px;
            justify-content: center;
            margin: 10px auto;
        }
        .cell {
            width: 40px;
            height: 40px;
            background-color: #ecf0f1;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            border-radius: 4px;
            background-size: cover; 
            background-position: center;
        }
        .wall { background-color: #34495e; }
        .exit { background-color: #27ae60; }
        
        /* Karakter FotoÄŸraflarÄ±nÄ±n CSS SÄ±nÄ±flarÄ± */
        .player-pobmek { background-image: url('pobmek.png'); background-color: transparent; }
        .player-solar { background-image: url('solar.png'); background-color: transparent; }
        
        .btn {
            padding: 15px 30px;
            font-size: 18px;
            margin: 10px;
            cursor: pointer;
            border: none;
            border-radius: 8px;
            background-color: #3498db;
            color: white;
            transition: 0.3s;
        }
        .btn:hover { background-color: #2980b9; }

        #popup {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: rgba(0, 0, 0, 0.9);
            color: #f1c40f;
            padding: 30px;
            border-radius: 15px;
            font-size: 28px;
            font-weight: bold;
            z-index: 1000;
            text-align: center;
            border: 3px solid #f1c40f;
        }
    </style>
</head>
<body>

    <div id="start-screen">
        <h1>Love You Teacher</h1>
        <p>Hurry up! Collect 5 students and escape before time runs out!</p>
        <button class="btn" onclick="startGame('pobmek')">Pobmek (Teacher)</button>
        <button class="btn" onclick="startGame('solar')">Solar (Teacher)</button>
    </div>

    <div id="game-container">
        <div class="header-info">
            <div id="teacher-name"></div>
            <div>Students: <span id="score">0</span> / 5</div>
            <div id="timer">Time: 60s</div>
        </div>
        
        <div id="maze"></div>
        <p>Use W, A, S, D or Arrow Keys to move.</p>
    </div>

    <div id="popup"></div>

    <script>
        let player = { x: 1, y: 1, id: '' }; 
        let studentsCollected = 0;
        let gameOver = false;
        let timeLeft = 60; // SÃ¼re 60 saniye yapÄ±ldÄ±
        let timerInterval;
        let enemyInterval;
        let pathHistory = []; 

        const initialMap = [
            [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
            [1, 0, 0, 0, 1, 2, 0, 0, 0, 0, 0, 1],
            [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1],
            [1, 0, 1, 0, 0, 0, 0, 0, 2, 1, 0, 1],
            [1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1],
            [1, 2, 0, 0, 1, 0, 1, 0, 0, 0, 0, 1],
            [1, 1, 1, 0, 1, 0, 1, 0, 1, 1, 1, 1],
            [1, 0, 0, 0, 0, 0, 0, 0, 1, 3, 1, 1],
            [1, 0, 1, 1, 1, 1, 1, 0, 1, 0, 0, 1],
            [1, 0, 0, 0, 2, 1, 0, 0, 0, 0, 2, 1],
            [1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 1, 1],
            [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
        ];
        
        let map = JSON.parse(JSON.stringify(initialMap));

        let enemies = [
            { x: 3, y: 1, dx: 1, dy: 0 }, 
            { x: 5, y: 5, dx: 0, dy: 1 }, 
            { x: 7, y: 9, dx: 1, dy: 0 }  
        ];

        function startGame(characterId) {
            player.id = characterId;
            player.x = 1; 
            player.y = 1;
            pathHistory = [{x: 1, y: 1}];
            
            document.getElementById('start-screen').style.display = 'none';
            document.getElementById('game-container').style.display = 'block';
            
            if(characterId === 'pobmek') {
                document.getElementById('teacher-name').innerText = 'Teacher: Pobmek';
            } else {
                document.getElementById('teacher-name').innerText = 'Teacher: Solar';
            }
            
            drawMaze();
            document.addEventListener('keydown', movePlayer);
            
            timerInterval = setInterval(() => {
                if(gameOver) return;
                timeLeft--;
                document.getElementById('timer').innerText = `Time: ${timeLeft}s`;
                if (timeLeft <= 0) {
                    endGame("Time is up! The students are late!", false);
                }
            }, 1000);

            enemyInterval = setInterval(moveEnemies, 400);
        }

        function showPopup(msg, duration = 2000, callback = null) {
            const popup = document.getElementById('popup');
            popup.innerText = msg;
            popup.style.display = 'block';
            
            setTimeout(() => {
                popup.style.display = 'none';
                if(callback) callback();
            }, duration);
        }

        function moveEnemies() {
            if (gameOver) return;

            enemies.forEach(enemy => {
                let nextX = enemy.x + enemy.dx;
                let nextY = enemy.y + enemy.dy;

                if (map[nextY][nextX] === 1 || map[nextY][nextX] === 3) {
                    enemy.dx *= -1;
                    enemy.dy *= -1;
                } else {
                    enemy.x = nextX;
                    enemy.y = nextY;
                }

                if (enemy.x === player.x && enemy.y === player.y) {
                    timeLeft = Math.max(0, timeLeft - 5); 
                    document.getElementById('timer').innerText = `Time: ${timeLeft}s`;
                    showPopup("Watch out! -5 Seconds!", 1000);
                }
            });
            drawMaze();
        }

        function drawMaze() {
            const mazeDiv = document.getElementById('maze');
            mazeDiv.innerHTML = '';

            for (let y = 0; y < map.length; y++) {
                for (let x = 0; x < map[y].length; x++) {
                    const cell = document.createElement('div');
                    cell.classList.add('cell');
                    
                    let isEnemy = enemies.find(e => e.x === x && e.y === y);
                    let isTail = false;

                    for(let i = 1; i <= studentsCollected; i++) {
                        if (pathHistory[i] && pathHistory[i].x === x && pathHistory[i].y === y) {
                            isTail = true;
                            break;
                        }
                    }

                    if (x === player.x && y === player.y) {
                        cell.classList.add(player.id === 'pobmek' ? 'player-pobmek' : 'player-solar');
                    } else if (isTail) {
                        cell.innerText = 'ðŸ§’'; 
                    } else if (isEnemy) {
                        cell.innerText = 'ðŸ”¥'; 
                    } else if (map[y][x] === 1) {
                        cell.classList.add('wall');
                    } else if (map[y][x] === 2) {
                        cell.innerText = 'ðŸ§’'; 
                    } else if (map[y][x] === 3) {
                        cell.classList.add('exit');
                        cell.innerText = 'ðŸšª';
                    }
                    mazeDiv.appendChild(cell);
                }
            }
        }

        function movePlayer(e) {
            if (gameOver) return;

            if(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].indexOf(e.code) > -1) {
                e.preventDefault();
            }

            let newX = player.x;
            let newY = player.y;

            if (e.key === 'ArrowUp' || e.key === 'w') newY--;
            if (e.key === 'ArrowDown' || e.key === 's') newY++;
            if (e.key === 'ArrowLeft' || e.key === 'a') newX--;
            if (e.key === 'ArrowRight' || e.key === 'd') newX++;

            if (map[newY][newX] !== 1) {
                
                pathHistory.unshift({x: newX, y: newY});
                if (pathHistory.length > studentsCollected + 1) {
                    pathHistory.pop(); 
                }

                player.x = newX;
                player.y = newY;

                let hitEnemy = enemies.find(enemy => enemy.x === player.x && enemy.y === player.y);
                if(hitEnemy) {
                    timeLeft = Math.max(0, timeLeft - 5);
                    document.getElementById('timer').innerText = `Time: ${timeLeft}s`;
                    showPopup("Watch out! -5 Seconds!", 1000);
                }

                if (map[newY][newX] === 2) {
                    studentsCollected++;
                    map[newY][newX] = 0; 
                    document.getElementById('score').innerText = studentsCollected;
                    
                    showPopup("Pâ€™DOME SENÄ° TEBRÄ°K EDÄ°YOR", 2000); 
                }

                if (map[newY][newX] === 3) {
                    if (studentsCollected >= 5) {
                        endGame("LOVE YOU TEACHER Ã‡OK YAKINDA", true);
                    } else {
                        showPopup("You need 5 students to open the door!", 1500);
                    }
                }

                drawMaze();
            }
        }

        function endGame(message, isWin) {
            gameOver = true;
            clearInterval(timerInterval);
            clearInterval(enemyInterval);
            
            showPopup(message, 3000, () => {
                location.reload(); 
            });
        }
    </script>
</body>
</html>
